<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>전설의 포메이션 | Legendary Formation</title>
<meta name="description" content="포메이션·대륙·시대를 고르면 포지션별로 어울리는 선수를 랜덤 추천해주는 모바일 웹앱" />
<style>
  :root{
    --bg:#000000;
    --card:#121212;
    --muted:#b6c1b6;
    --acc:#7fffb4;
    --pill:#1c221c;
    --btn:#1e5c3a;
    --btn2:#254a7c;
  }
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:var(--bg);color:#e9f6ea;font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Noto Sans KR,Arial,sans-serif}
  header{padding:18px 16px 8px}
  h1{margin:0;font-size:20px}
  .sub{color:var(--muted);font-size:12px;margin-top:6px}

  .card{background:var(--card);border:1px solid #1f251f;border-radius:14px;padding:12px;margin:12px}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .field{flex:1;min-width:140px}
  label{display:block;font-size:12px;color:var(--muted);margin:8px 0 6px}
  select{width:100%;padding:12px 10px;border-radius:10px;border:1px solid #2a2f2a;background:#0e130e;color:#eaf5eb;appearance:none}
  .actions{display:flex;gap:8px;margin-top:10px}
  button{flex:1;padding:12px 10px;border:0;border-radius:12px;color:#fff;font-weight:600}
  .primary{background:var(--btn)}
  .secondary{background:var(--btn2)}
  .hint{font-size:12px;color:var(--muted);margin-top:8px}
  .pill{display:inline-flex;align-items:center;gap:6px;background:var(--pill);border:1px solid #2a312a;border-radius:999px;padding:6px 10px;font-size:12px;margin:4px 6px 0 0}

  /* 우리 진영 하프코트 */
  .pitch-wrap{padding:12px}
  .pitch{
    position:relative;width:100%;max-width:560px;margin:0 auto;border:2px solid #dce8dd;border-radius:14px;
    background:
      linear-gradient(180deg,#142d14 0 12%,#183618 12% 24%,#142d14 24% 36%,#183618 36% 48%,#142d14 48% 60%,#183618 60% 72%,#142d14 72% 84%,#183618 84% 100%);
    aspect-ratio: 10/13; /* 세로형 반코트 */
    overflow:hidden;
  }
  /* 상단(하프라인)은 생략, 우리 페널티지역만 표기 */
  .penalty{position:absolute;left:12%;right:12%;bottom:4%;height:18%;border:2px solid rgba(255,255,255,.7);border-bottom:0;border-radius:10px 10px 0 0}
  .six{position:absolute;left:32%;right:32%;bottom:4%;height:10%;border:2px solid rgba(255,255,255,.7);border-bottom:0;border-radius:10px 10px 0 0}
  .goal{position:absolute;left:44%;right:44%;bottom:2%;height:4%;border:2px solid rgba(255,255,255,.9);border-bottom:0;border-radius:4px 4px 0 0;background:rgba(255,255,255,.12)}

  /* 선수 말풍선 */
  .player{
    position:absolute;transform:translate(-50%,-50%);
    background:rgba(8,12,8,.8);backdrop-filter:saturate(130%) blur(2px);
    border:1px solid rgba(223,255,230,.2);border-radius:12px;padding:6px 8px;min-width:72px;
    text-align:center;font-size:12px;line-height:1.25
  }
  .pos{font-size:10px;color:#a9e4bf}
  .name{font-weight:700}

  .list{margin:8px 12px 18px}
  .list h3{margin:10px 0 8px;font-size:14px;color:#bfe8cd}
  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:8px}
  .card2{background:#0e130e;border:1px solid #233223;border-radius:10px;padding:8px}
  .copy{user-select:all}

  footer{padding:18px 16px 44px;color:#b9c7bb;font-size:12px}
  a{color:var(--acc);text-decoration:none}
</style>
</head>
<body>
<header>
  <h1>전설의 포메이션</h1>
  <div class="sub">상단=FW, 가운데=MF, 하단=DF · 우리 진영만 표시</div>
</header>

<section class="card">
  <div class="row">
    <div class="field">
      <label>1단계 · 포메이션</label>
      <select id="formation">
        <option>3-5-2</option>
        <option>3-4-3</option>
        <option>4-4-2</option>
        <option selected>4-3-3</option>
        <option>1-1-8</option>
      </select>
    </div>
    <div class="field">
      <label>2단계 · 대륙</label>
      <select id="continent">
        <option value="europe">유럽</option>
        <option value="asia">아시아</option>
        <option value="south_america">남미</option>
        <option value="global" selected>글로벌(전세계)</option>
      </select>
    </div>
    <div class="field" style="flex-basis:100%">
      <label>3단계 · 선수 시대</label>
      <select id="era">
        <option value="current" selected>현역</option>
        <option value="legend">레전드</option>
      </select>
    </div>
  </div>
  <div class="actions">
    <button class="primary" id="genBtn">추천 생성</button>
    <button class="secondary" id="rerollBtn">재추천(이름만)</button>
  </div>
  <div class="hint"><span class="pill">상단=FW</span><span class="pill">중단=MF</span><span class="pill">하단=DF+GK</span></div>
</section>

<section class="pitch-wrap">
  <div class="pitch" id="pitch">
    <div class="penalty"></div>
    <div class="six"></div>
    <div class="goal"></div>
  </div>
</section>

<section class="list card" id="listWrap" hidden>
  <h3>선발 명단</h3>
  <div class="grid" id="listGrid"></div>
</section>

<footer>
  <div>Made for <strong>fantasticsean</strong></div>
  <div style="margin-top:6px">Project URL: <span class="copy">https://fantasticsean.github.io/legendary_formation/</span></div>
</footer>

<script>
/* ---------- 선수 데이터 ---------- */
const DATA = {
  current: {
    europe: {
      GK: ["Courtois","ter Stegen","Oblak","Donnarumma","Maignan"],
      DF: ["Van Dijk","Dias","Stones","Hernández","Alexander-Arnold","Cancelo","Rüdiger","Alaba"],
      MF: ["De Bruyne","Modrić","Rodri","Bellingham","Ødegaard","Kroos"],
      FW: ["Haaland","Mbappé","Kane","Lewandowski","Salah"]
    },
    asia: {
      GK: ["Kawashima","Kim Seung-gyu","Beiranvand","Kwon Sun-tae"],
      DF: ["Kim Min-jae","Tomiyasu","Yoshida","Sakai","Nagatomo","Ali Adnan"],
      MF: ["Lee Kang-in","Kagawa","Morita","Kamada","Son Jun-ho","Al-Dawsari"],
      FW: ["Son Heung-min","Taremi","Azmoun","Hwang Hee-chan","Minamino"]
    },
    south_america: {
      GK: ["Alisson","Ederson","Martínez"],
      DF: ["Marquinhos","Romero","Lisandro Martínez","Thiago Silva","Araújo"],
      MF: ["Casemiro","Valverde","De Paul","Enzo Fernández","Guimarães"],
      FW: ["Messi","Neymar","Vinícius","Lautaro","Suárez"]
    }
  },
  legend: {
    europe: {
      GK: ["Casillas","Buffon","Schmeichel","Kahn"],
      DF: ["Maldini","Beckenbauer","Sergio Ramos","Puyol","Lahm","Nesta"],
      MF: ["Zidane","Xavi","Iniesta","Gerrard","Lampard","Pirlo"],
      FW: ["Cristiano Ronaldo","Henry","van Basten","Shevchenko","Ibrahimović"]
    },
    asia: {
      GK: ["Lee Woon-jae","Kawaguchi"],
      DF: ["Hong Myung-bo","Lee Young-pyo","Mahdavikia","Sun Jihai"],
      MF: ["Park Ji-sung","Nakata","Nakamura","Honda","Cha Du-ri"],
      FW: ["Cha Bum-kun","Ali Daei","Al-Jaber","Majed Abdullah"]
    },
    south_america: {
      GK: ["Taffarel","Higuita","Rogério Ceni"],
      DF: ["Cafu","Roberto Carlos","Passarella","Aldair"],
      MF: ["Maradona","Zico","Riquelme","Ronaldinho"],
      FW: ["Pelé","Ronaldo","Romário","Garrincha","Batistuta"]
    }
  }
};

/* ---------- 풀 조합 ---------- */
function getPool(era, continent){
  const erasrc = DATA[era];
  const buckets = ["GK","DF","MF","FW"];
  const merge = (objs) => {
    const out = {GK:[],DF:[],MF:[],FW:[]};
    objs.forEach(o => buckets.forEach(k => out[k].push(...(o?.[k]||[]))));
    return out;
  };
  if(continent==="global") return merge(Object.values(erasrc));
  return erasrc[continent] ?? merge(Object.values(erasrc));
}

/* ---------- 포메이션 파싱 (DF-MF-FW + GK 1) ---------- */
function formationToCounts(fstr){
  const [d,m,f] = fstr.split("-").map(n=>parseInt(n,10));
  return {GK:1, DF:d, MF:m, FW:f};
}

/* ---------- 좌표 계산 (상단=FW, 중단=MF, 하단=DF, 맨아래=GK) ---------- */
function rowY(group){
  // 하프코트 내에서 시각적으로 자연스러운 밴드 고정
  // 상단(공격) 24~30, 중단(미들) 48~56, 하단(수비) 72~80, GK 94
  if(group==="FW") return 28;
  if(group==="MF") return 52;
  if(group==="DF") return 76;
  return 94; // GK
}
function spreadX(n, pad=16){
  // 좌우 pad% 여백 두고 균등 분포
  const xs = [];
  if(n<=0) return xs;
  if(n===1){ xs.push(50); return xs; }
  const start = pad, end = 100-pad;
  const step = (end-start)/(n-1);
  for(let i=0;i<n;i++) xs.push(start + step*i);
  return xs;
}
function computePositions(counts){
  const out = [];
  // GK
  out.push({pos:"GK", x:50, y:rowY("GK")});
  // DF/MF/FW 라인: x를 균등 분포, y는 라인 고정
  ["DF","MF","FW"].forEach(group=>{
    const n = counts[group];
    const xs = spreadX(n, 16);
    const y = rowY(group);
    xs.forEach(x=> out.push({pos:group, x, y}));
  });
  return out;
}

/* ---------- 샘플링 ---------- */
function sampleNoRepeat(arr, n){
  const pool = [...new Set(arr)];
  const out = [];
  while(out.length<n && pool.length){
    const idx = Math.floor(Math.random()*pool.length);
    out.push(pool.splice(idx,1)[0]);
  }
  while(out.length<n && out.length>0){
    out.push(out[Math.floor(Math.random()*out.length)]);
  }
  return out;
}
function pickSquad(pool, counts){
  return {
    GK: sampleNoRepeat(pool.GK, counts.GK),
    DF: sampleNoRepeat(pool.DF, counts.DF),
    MF: sampleNoRepeat(pool.MF, counts.MF),
    FW: sampleNoRepeat(pool.FW, counts.FW)
  };
}

/* ---------- 렌더 ---------- */
const elPitch = document.getElementById('pitch');
const elListWrap = document.getElementById('listWrap');
const elListGrid = document.getElementById('listGrid');

function renderPitch(coords, squad){
  elPitch.querySelectorAll('.player').forEach(n=>n.remove());
  const add = (x,y,pos,name) => {
    const d = document.createElement('div');
    d.className = 'player';
    d.style.left = x+'%';
    d.style.top = y+'%';
    d.innerHTML = `<div class="pos">${pos}</div><div class="name">${name}</div>`;
    elPitch.appendChild(d);
  };
  // GK
  add(coords[0].x, coords[0].y, 'GK', squad.GK[0] || '—');
  // 나머지 (DF→MF→FW 순서로 붙여도 좌표는 이미 정렬되어 시각적으로 맞음)
  let iD=0, iM=0, iF=0;
  coords.slice(1).forEach(c=>{
    if(c.pos==='DF') add(c.x,c.y,'DF',squad.DF[iD++]||'—');
    if(c.pos==='MF') add(c.x,c.y,'MF',squad.MF[iM++]||'—');
    if(c.pos==='FW') add(c.x,c.y,'FW',squad.FW[iF++]||'—');
  });
}
function renderList(squad){
  elListWrap.hidden = false;
  elListGrid.innerHTML = '';
  const order = ['GK','DF','MF','FW'];
  order.forEach(group=>{
    squad[group].forEach((name,idx)=>{
      const card = document.createElement('div');
      card.className = 'card2';
      card.innerHTML = `<div style="font-size:11px;color:#9ccfb0;margin-bottom:4px">${group}${group==='GK'?'':(' ' + (idx+1))}</div><div style="font-weight:700">${name}</div>`;
      elListGrid.appendChild(card);
    });
  });
}

/* ---------- 제어 ---------- */
const $ = id => document.getElementById(id);
function generate(){
  const formation = $('formation').value;
  const continent = $('continent').value;
  const era = $('era').value;
  const counts = formationToCounts(formation);
  const coords = computePositions(counts);
  const pool = getPool(era, continent);
  const squad = pickSquad(pool, counts);
  renderPitch(coords, squad);
  renderList(squad);
}
$('genBtn').addEventListener('click', generate);
$('rerollBtn').addEventListener('click', generate);
generate();
</script>
</body>
</html>
